<Window x:Class="LegoClickerCS.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Lego Clicker Loader"
        Width="300" Height="240"
        WindowStyle="SingleBorderWindow"
        ResizeMode="NoResize"
        Background="{DynamicResource BgBrush}"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <SolidColorBrush x:Key="ControlCenterTabSelectedBrush" Color="#7C65B0"/>
        <SolidColorBrush x:Key="ControlCenterTabHoverBrush" Color="#4E3D72"/>

        <Style x:Key="ControlCenterTabItemStyle" TargetType="TabItem">
            <Setter Property="Foreground" Value="{DynamicResource DimTextBrush}"/>
            <Setter Property="Padding" Value="14,10"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="tabBorder"
                                Background="{DynamicResource SliderBgBrush}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              ContentSource="Header"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="tabBorder" Property="Background" Value="{StaticResource ControlCenterTabHoverBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="tabBorder" Property="Background" Value="{StaticResource ControlCenterTabSelectedBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ControlCenterTabControlStyle" TargetType="TabControl">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180"/>
                                <ColumnDefinition Width="12"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0"
                                    Background="{DynamicResource PanelBrush}"
                                    CornerRadius="12"
                                    Padding="8">
                                <TabPanel IsItemsHost="True"
                                          KeyboardNavigation.TabIndex="1"
                                          Background="Transparent"/>
                            </Border>

                            <Border Grid.Column="2"
                                    Background="{DynamicResource BgBrush}"
                                    BorderBrush="{DynamicResource PanelBrush}"
                                    BorderThickness="1"
                                    CornerRadius="12">
                                <ContentPresenter x:Name="PART_SelectedContentHost"
                                                  ContentSource="SelectedContent"
                                                  Margin="0"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <!-- Minimal loader (default / 1.8.9) -->
        <StackPanel x:Name="LoaderPanel" VerticalAlignment="Center">
            <TextBlock Text="Injection Control" Foreground="{DynamicResource TextBrush}"
                       FontSize="16" FontWeight="Bold" Margin="0,0,0,10" HorizontalAlignment="Center"/>
            <TextBlock Text="Supported versions: 1.8.9 and 1.21.11 (auto-detected)"
                       Foreground="{DynamicResource DimTextBrush}"
                       FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,10"/>

            <Button x:Name="InjectButton" Content="Inject / Connect" Height="35"
                    Style="{StaticResource DarkButton}" Click="InjectButton_Click"
                    FontSize="14" Margin="0,0,0,10" Cursor="Hand">
                <Button.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                </Button.Effect>
            </Button>

            <TextBlock x:Name="InjectionStatusText"
                       Text="Status: Not Injected"
                       Foreground="{DynamicResource DimTextBrush}"
                       FontSize="12" HorizontalAlignment="Center"/>
            <ProgressBar x:Name="InjectionProgressBar"
                         Minimum="0"
                         Maximum="100"
                         Height="6"
                         Foreground="{DynamicResource AccentBrush}"
                         Background="{DynamicResource SliderBgBrush}"
                         Margin="0,8,0,0"
                         Visibility="Collapsed"/>
        </StackPanel>

        <!-- 1.21 control center (shown after connect) -->
        <TabControl x:Name="ControlPanel"
                    Visibility="Collapsed"
                    TabStripPlacement="Left"
                    Style="{StaticResource ControlCenterTabControlStyle}"
                    ItemContainerStyle="{StaticResource ControlCenterTabItemStyle}"
                    Background="{DynamicResource BgBrush}"
                    BorderThickness="0"
                    Padding="0"
                    Margin="0">
            <TabItem Header="Combat">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12,0,0,0">
                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <CheckBox Content="AutoClicker" IsChecked="{Binding IsArmed, Mode=OneWay}" Style="{StaticResource ModuleSwitch}" Click="ToggleArmed_Click"/>
                                <TextBlock Text="{Binding StatusText}" Foreground="{DynamicResource AccentBrush}" FontSize="12" Margin="0,4,0,10" />

                                <DockPanel>
                                    <TextBlock Text="Min CPS" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding MinCPS, StringFormat={}{0:0}}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="25" Value="{Binding MinCPS, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkSlider}"/>

                                <DockPanel Margin="0,6,0,0">
                                    <TextBlock Text="Max CPS" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding MaxCPS, StringFormat={}{0:0}}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="25" Value="{Binding MaxCPS, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkSlider}"/>

                                <WrapPanel Margin="0,10,0,0">
                                    <CheckBox Content="Jitter" IsChecked="{Binding JitterEnabled, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}" Margin="0,0,14,0"/>
                                    <CheckBox Content="Click in Chests" IsChecked="{Binding ClickInChests, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}" Margin="0,0,14,0"/>
                                    <CheckBox Content="Pause when breaking" IsChecked="{Binding BreakBlocksEnabled, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>

                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="Right Click" Foreground="{DynamicResource TextBrush}" FontSize="16" FontWeight="Bold" />
                                <CheckBox Content="Enable Right Click" IsChecked="{Binding RightClickEnabled, Mode=TwoWay}" Style="{StaticResource ModuleSwitch}" Margin="0,8,0,10"/>

                                <DockPanel>
                                    <TextBlock Text="Right Min CPS" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding RightMinCPS, StringFormat={}{0:0}}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="25" Value="{Binding RightMinCPS, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkSlider}"/>

                                <DockPanel Margin="0,6,0,0">
                                    <TextBlock Text="Right Max CPS" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding RightMaxCPS, StringFormat={}{0:0}}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="25" Value="{Binding RightMaxCPS, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkSlider}"/>

                                <CheckBox Content="Only when holding block" IsChecked="{Binding RightClickOnlyBlock, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}" Margin="0,10,0,0"/>
                            </StackPanel>
                        </Border>

                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12">
                            <StackPanel>
                                <CheckBox Content="Aim Assist (1.21)" IsChecked="{Binding AimAssistEnabled, Mode=TwoWay}" Style="{StaticResource ModuleSwitch}"/>

                                <DockPanel Margin="0,10,0,0" IsEnabled="{Binding AimAssistEnabled}">
                                    <TextBlock Text="FOV" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding AimAssistFov, StringFormat={}{0:0}}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="180"
                                        Value="{Binding AimAssistFov, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource DarkSlider}" IsEnabled="{Binding AimAssistEnabled}"/>

                                <DockPanel Margin="0,8,0,0" IsEnabled="{Binding AimAssistEnabled}">
                                    <TextBlock Text="Range" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding AimAssistRange, StringFormat={}{0:0.0}}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="12"
                                        Value="{Binding AimAssistRange, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource DarkSlider}" IsEnabled="{Binding AimAssistEnabled}"/>

                                <DockPanel Margin="0,8,0,0" IsEnabled="{Binding AimAssistEnabled}">
                                    <TextBlock Text="Strength (%)" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding AimAssistStrength}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="100" TickFrequency="1" IsSnapToTickEnabled="True"
                                        Value="{Binding AimAssistStrength, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource DarkSlider}" IsEnabled="{Binding AimAssistEnabled}"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Render">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12,0,0,0">
                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <CheckBox Content="Nametags" IsChecked="{Binding NametagsEnabled, Mode=TwoWay}" Style="{StaticResource ModuleSwitch}"/>
                                <WrapPanel Margin="0,10,0,0" IsEnabled="{Binding NametagsEnabled}">
                                    <CheckBox Content="Show Health" IsChecked="{Binding NametagShowHealth, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}" Margin="0,0,14,0"/>
                                    <CheckBox Content="Show Armor" IsChecked="{Binding NametagShowArmor, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}" Margin="0,0,14,0"/>
                                    <CheckBox Content="Show Item" IsChecked="{Binding NametagShowHeldItem, Mode=TwoWay}" Style="{StaticResource DarkCheckBox}" />
                                </WrapPanel>
                                <DockPanel Margin="0,10,0,0" IsEnabled="{Binding NametagsEnabled}">
                                    <TextBlock Text="Nametag Count" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding NametagMaxCount}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="20" TickFrequency="1" IsSnapToTickEnabled="True"
                                        Value="{Binding NametagMaxCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource DarkSlider}" IsEnabled="{Binding NametagsEnabled}"/>
                            </StackPanel>
                        </Border>

                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <CheckBox Content="Chest ESP" IsChecked="{Binding ChestEspEnabled, Mode=TwoWay}" Style="{StaticResource ModuleSwitch}"/>
                                <DockPanel Margin="0,10,0,0" IsEnabled="{Binding ChestEspEnabled}">
                                    <TextBlock Text="Chest Count" Foreground="{DynamicResource TextBrush}" FontSize="12" DockPanel.Dock="Left" />
                                    <TextBlock Text="{Binding ChestEspMaxCount}" Foreground="{DynamicResource DimTextBrush}" FontSize="12" HorizontalAlignment="Right" DockPanel.Dock="Right" />
                                </DockPanel>
                                <Slider Minimum="1" Maximum="20" TickFrequency="1" IsSnapToTickEnabled="True"
                                        Value="{Binding ChestEspMaxCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource DarkSlider}" IsEnabled="{Binding ChestEspEnabled}"/>
                            </StackPanel>
                        </Border>

                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12">
                            <StackPanel>
                                <CheckBox Content="Closest Player" IsChecked="{Binding ClosestPlayerInfoEnabled, Mode=TwoWay}" Style="{StaticResource ModuleSwitch}"/>
                                <TextBlock Text="Includes 4-way direction arrow (^, v, &lt;, &gt;)." Foreground="{DynamicResource DimTextBrush}" FontSize="12" Margin="0,8,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Utility">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12,0,0,0">
                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <CheckBox Content="GTB Helper (1.21)" IsChecked="{Binding GtbHelperEnabled, Mode=TwoWay}" Style="{StaticResource ModuleSwitch}"/>
                                <TextBlock Text="Hypixel Guess The Build helper using action-bar hints." Foreground="{DynamicResource DimTextBrush}" FontSize="12" Margin="0,8,0,0"/>
                            </StackPanel>
                        </Border>

                        <Border Background="{DynamicResource PanelBrush}" CornerRadius="12" Padding="12">
                            <StackPanel>
                                <TextBlock Text="Module Keybinds" Foreground="{DynamicResource TextBrush}" FontSize="16" FontWeight="Bold"/>
                                <TextBlock Text="Click a button, then press a key (Esc = unbind)." Foreground="{DynamicResource DimTextBrush}" FontSize="12" Margin="0,4,0,10"/>
                                <WrapPanel>
                                    <Button x:Name="KeybindAutoclickerButton" Tag="autoclicker" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindRightClickButton" Tag="rightclick" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindJitterButton" Tag="jitter" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindClickInChestsButton" Tag="clickinchests" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindBreakBlocksButton" Tag="breakblocks" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindAimAssistButton" Tag="aimassist" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindGtbHelperButton" Tag="gtbhelper" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindNametagsButton" Tag="nametags" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindChestEspButton" Tag="chestesp" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                    <Button x:Name="KeybindClosestPlayerButton" Tag="closestplayer" Click="KeybindButton_Click" Style="{StaticResource DarkButton}" Margin="0,0,8,8" Width="170"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
